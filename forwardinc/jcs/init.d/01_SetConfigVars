
PROP_FILE=/solution${CONFIG}/data/jcs_external.properties

jcs_jmsCredentials_password=$(grep -Po "(?<=^jcs_jmsCredentials_password=).*" $PROP_FILE)

encryptPWD=${jcs_jmsCredentials_password:5}

proxyCCSManager_enabled=$(grep -Po "(?<=^proxyCCSManager_enabled=).*" $PROP_FILE)

proxyConnectionConfig_proxyServerHostname=$(grep -Po "(?<=^proxyConnectionConfig_proxyServerHostname=).*" $PROP_FILE)

proxyConnectionConfig_proxyServerUseSsl=$(grep -Po "(?<=^proxyConnectionConfig_proxyServerUseSsl=).*" $PROP_FILE)

httpProxyConfiguration_enabled=$(grep -Po "(?<=^httpProxyConfiguration_enabled=).*" $PROP_FILE)

endpointManagementService_managementVisible=$(grep -Po "(?<=^endpointManagementService_managementVisible=).*" $PROP_FILE)

standaloneConfiguration_enabled=$(grep -Po "(?<=^standaloneConfiguration_enabled=).*" $PROP_FILE)

standaloneConfiguration_domain=$(grep -Po "(?<=^standaloneConfiguration_domain=).*" $PROP_FILE)

connectorPersister_enabled=$(grep -Po "(?<=^connectorPersister_enabled=).*" $PROP_FILE)

jcs_fips_enabled=$(grep -Po "(?<=^jcs_fips_enabled=).*" $PROP_FILE)

# copy user config override folder into jcs/conf/override/
cp -r /solution${CONFIG}/config/override/* $JCS_HOME_DIR/conf/override/ 

# replace placeholders in jcs config properties
sed -i "s/@jcs_jmsCredentials_password@/$jcs_jmsCredentials_password/g" $JCS_HOME_DIR/conf/override/server_ad.properties
sed -i "s/@jcs_fips_enabled@/$jcs_fips_enabled/g" $JCS_HOME_DIR/conf/override/server_ad.properties
sed -i "s/@proxyCCSManager_enabled@/$proxyCCSManager_enabled/g" $JCS_HOME_DIR/conf/override/server_ccs.properties
sed -i "s/@jcs_jmsCredentials_password@/$jcs_jmsCredentials_password/g" $JCS_HOME_DIR/conf/override/server_ccs.properties
sed -i "s/@proxyCCSManager_enabled@/$proxyCCSManager_enabled/g" $JCS_HOME_DIR/conf/override/server_ccs.properties
sed -i "s/@proxyConnectionConfig_proxyServerHostname@/$proxyConnectionConfig_proxyServerHostname/g" $JCS_HOME_DIR/conf/override/server_ccs.properties
sed -i "s/@proxyConnectionConfig_proxyServerUseSsl@/$proxyConnectionConfig_proxyServerUseSsl/g" $JCS_HOME_DIR/conf/override/server_ccs.properties
sed -i "s/@httpProxyConfiguration_enabled@/$httpProxyConfiguration_enabled/g" $JCS_HOME_DIR/conf/override/server_jcs.properties
sed -i "s/@jcs_jmsCredentials_password@/$jcs_jmsCredentials_password/g" $JCS_HOME_DIR/conf/override/server_jcs.properties
sed -i "s/@JsafeJCE_fipsEnabled@/$jcs_fips_enabled/g" $JCS_HOME_DIR/conf/override/server_jcs.properties
sed -i "s/@endpointManagementService_managementVisible@/$endpointManagementService_managementVisible/g" $JCS_HOME_DIR/conf/override/server_ui.properties
sed -i "s/@jcs_jmsCredentials_password@/$jcs_jmsCredentials_password/g" $JCS_HOME_DIR/conf/override/server_common.properties
sed -i "s/@standaloneConfiguration_enabled@/$standaloneConfiguration_enabled/g" $JCS_HOME_DIR/conf/override/server_jcs_standalone.properties
sed -i "s/@standaloneConfiguration_domain@/$standaloneConfiguration_domain/g" $JCS_HOME_DIR/conf/override/server_jcs_standalone.properties
sed -i "s/@connectorPersister_enabled@/$connectorPersister_enabled/g" $JCS_HOME_DIR/conf/override/server_jcs_standalone.properties
sed -i "s/@jcs_jmsCredentials_password@/$jcs_jmsCredentials_password/g" $JCS_HOME_DIR/conf/override/server_shared.properties
sed -i "s/@jcs_jmsCredentials_password@/$encryptPWD/g" $CONNECTOR_SERVER_HOME/etc/system.properties

