{
  "apiVersion": "v1",
  "kind": "Template",
  "metadata": {
    "annotations": {
      "description": "CA Identity Suite 12.6.06.ga ForwardInc"
    },
    "creationTimestamp": null,
    "name": "idsuite-12-6-06-ga-forwardinc",
    "namespace": "idsuite-12-6-06-ga-forwardinc"
  },
  "objects": [
    {
      "apiVersion": "v1",
      "kind": "Namespace",
      "metadata": {
        "name": "${SOLUTION_NAMESPACE}"
      }
    },
    {
      "apiVersion": "v1",
      "kind": "ReplicationController",
      "metadata": {
        "name": "database"
      },
      "spec": {
        "replicas": 1,
        "selector": {
          "ca.com/im": "database"
        },
        "template": {
          "metadata": {
            "labels": {
              "ca.com/im": "database"
            },
            "name": "database"
          },
          "spec": {
            "containers": [
              {
                "env": [
                  {
                    "name": "DESTINATION",
                    "value": "/solution"
                  },
                  {
                    "name": "GITHUB_TOKEN",
                    "value": "${OAUTH_TOKEN}"
                  },
                  {
                    "name": "SOURCE",
                    "value": "${SOLUTION_CONFIGURATION}"
                  }
                ],
                "image": "store.vapp-security.solutions/vapp/sidecar-configsvc:latest",
                "name": "configuration",
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              },
              {
                "env": [
                  {
                    "name": "CONFIG",
                    "value": "forwardinc/mysql"
                  }
                ],
                "image": "store.vapp-security.solutions/vapp/mysql:latest",
                "name": "database",
                "ports": [
                  {
                    "containerPort": 3306
                  }
                ],
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              }
            ],
            "dnsPolicy": "ClusterFirst",
            "restartPolicy": "Always",
            "volumes": [
              {
                "name": "configuration",
                "emptyDir": {}
              }
            ]
          }
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "ReplicationController",
      "metadata": {
        "name": "connserver"
      },
      "spec": {
        "replicas": 1,
        "selector": {
          "ca.com/im": "connserver"
        },
        "template": {
          "metadata": {
            "labels": {
              "ca.com/im": "connserver"
            },
            "name": "connserver"
          },
          "spec": {
            "containers": [
              {
                "env": [
                  {
                    "name": "DESTINATION",
                    "value": "/solution"
                  },
                  {
                    "name": "GITHUB_TOKEN",
                    "value": "${OAUTH_TOKEN}"
                  },
                  {
                    "name": "SOURCE",
                    "value": "${SOLUTION_CONFIGURATION}"
                  }
                ],
                "image": "store.vapp-security.solutions/vapp/sidecar-configsvc:latest",
                "name": "configuration",
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              },
              {
                "env": [
                  {
                    "name": "CONFIG",
                    "value": "forwardinc/jcs"
                  }
                ],
                "image": "store.vapp-security.solutions/imag/connector-server:12.6.06.ga",
                "name": "connserver",
                "ports": [
                  {
                    "containerPort": 20080
                  },
                  {
                    "containerPort": 20410
                  },
                  {
                    "containerPort": 20411
                  },
                  {
                    "containerPort": 20443
                  },
                  {
                    "containerPort": 22001
                  },
                  {
                    "containerPort": 22002
                  },
                  {
                    "containerPort": 22099
                  }
                ],
                "readinessProbe": {
                  "tcpSocket": {
                    "port": 20410
                  },
                  "initialDelaySeconds": 60
                },
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              }
            ],
            "dnsPolicy": "ClusterFirst",
            "restartPolicy": "Always",
            "volumes": [
              {
                "name": "configuration",
                "emptyDir": {}
              }
            ]
          }
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "ReplicationController",
      "metadata": {
        "name": "identity-portal-server"
      },
      "spec": {
        "replicas": 1,
        "selector": {
          "ca.com/im": "identity-portal-server"
        },
        "template": {
          "metadata": {
            "labels": {
              "ca.com/im": "identity-portal-server"
            },
            "name": "identity-portal-server"
          },
          "spec": {
            "containers": [
              {
                "env": [
                  {
                    "name": "GITHUB_TOKEN",
                    "value": "${OAUTH_TOKEN}"
                  },
                  {
                    "name": "SOURCE",
                    "value": "${SOLUTION_CONFIGURATION}"
                  },
                  {
                    "name": "DESTINATION",
                    "value": "/solution"
                  }
                ],
                "image": "store.vapp-security.solutions/vapp/sidecar-configsvc:latest",
                "name": "configuration",
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              },
              {
                "env": [
                  {
                    "name": "CONFIG",
                    "value": "forwardinc/identity-portal"
                  },
                  {
                    "name": "IG_DB_HOST",
                    "value": "${IG_DB_HOST}"
                  },
                  {
                    "name": "IG_DB_USER",
                    "value": "${IG_DB_USER}"
                  },
                  {
                    "name": "IG_DB_PASSWORD",
                    "value": "${IG_DB_PASSWORD}"
                  },
                  {
                    "name": "IG_DB_PORT",
                    "value": "${IG_DB_PORT}"
                  },
                  {
                    "name": "IG_DB_VENDOR",
                    "value": "${IG_DB_VENDOR}"
                  }
                ],
                "image": "store.vapp-security.solutions/imag/identity-portal-server:12.6.06.ga",
                "name": "identity-portal-server",
                "ports": [
                  {
                    "containerPort": 8080
                  },
                  {
                    "containerPort": 8443
                  }
                ],
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              }
            ],
            "dnsPolicy": "ClusterFirst",
            "restartPolicy": "Always",
            "volumes": [
              {
                "name": "configuration",
                "emptyDir": {}
              }
            ]
          }
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "ReplicationController",
      "metadata": {
        "name": "ig-server"
      },
      "spec": {
        "replicas": 1,
        "selector": {
          "ca.com/im": "ig-server"
        },
        "template": {
          "metadata": {
            "labels": {
              "ca.com/im": "ig-server"
            },
            "name": "ig-server"
          },
          "spec": {
            "containers": [
              {
                "env": [
                  {
                    "name": "DESTINATION",
                    "value": "/solution"
                  },
                  {
                    "name": "GITHUB_TOKEN",
                    "value": "${OAUTH_TOKEN}"
                  },
                  {
                    "name": "SOURCE",
                    "value": "${SOLUTION_CONFIGURATION}"
                  }
                ],
                "image": "store.vapp-security.solutions/vapp/sidecar-configsvc:latest",
                "name": "configuration",
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              },
              {
                "env": [
                  {
                    "name": "CONFIG",
                    "value": "forwardinc/igserver"
                  },
                  {
                    "name": "IG_DB_HOST",
                    "value": "${IG_DB_HOST}"
                  },
                  {
                    "name": "IG_DB_USER",
                    "value": "${IG_DB_USER}"
                  },
                  {
                    "name": "IG_DB_PASSWORD",
                    "value": "${IG_DB_PASSWORD}"
                  },
                  {
                    "name": "IG_DB_PORT",
                    "value": "${IG_DB_PORT}"
                  },
                  {
                    "name": "IG_DB_VENDOR",
                    "value": "${IG_DB_VENDOR}"
                  },
                  {
                    "name": "IG_DBS_PASSWORDS",
                    "value": "${IG_DBS_PASSWORDS}"
                  }
                ],
                "image": "store.vapp-security.solutions/imag/ig-server:latest",
                "name": "ig-server",
                "ports": [
                  {
                    "containerPort": 8080
                  },
                  {
                    "containerPort": 8443
                  }
                ],
                "readinessProbe": {
                  "exec": {
                    "command": [
                      "echo",
                      "test"
                    ]
                  },
                  "initialDelaySeconds": 300
                },
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              }
            ],
            "dnsPolicy": "ClusterFirst",
            "restartPolicy": "Always",
            "volumes": [
              {
                "name": "configuration",
                "emptyDir": {}
              }
            ]
          }
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "ReplicationController",
      "metadata": {
        "name": "im-server"
      },
      "spec": {
        "replicas": 1,
        "selector": {
          "ca.com/im": "im-server"
        },
        "template": {
          "metadata": {
            "labels": {
              "ca.com/im": "im-server"
            },
            "name": "im-server"
          },
          "spec": {
            "containers": [
              {
                "env": [
                  {
                    "name": "DESTINATION",
                    "value": "/solution"
                  },
                  {
                    "name": "GITHUB_TOKEN",
                    "value": "${OAUTH_TOKEN}"
                  },
                  {
                    "name": "SOURCE",
                    "value": "${SOLUTION_CONFIGURATION}"
                  }
                ],
                "image": "store.vapp-security.solutions/vapp/sidecar-configsvc:latest",
                "name": "configuration",
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              },
              {
                "env": [
                  {
                    "name": "CONFIG",
                    "value": "forwardinc/appsrv"
                  }
                ],
                "image": "store.vapp-security.solutions/imag/im-server:12.6.06.ga",
                "name": "im-server",
                "ports": [
                  {
                    "containerPort": 8080
                  },
                  {
                    "containerPort": 8443
                  }
                ],
                "readinessProbe": {
                  "httpGet": {
                    "path": "/iam/im/forwardinc",
                    "port": 8080
                  },
                  "initialDelaySeconds": 120
                },
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              }
            ],
            "dnsPolicy": "ClusterFirst",
            "restartPolicy": "Always",
            "volumes": [
              {
                "name": "configuration",
                "emptyDir": {}
              }
            ]
          }
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "ReplicationController",
      "metadata": {
        "name": "provdir"
      },
      "spec": {
        "replicas": 1,
        "selector": {
          "ca.com/im": "provdir"
        },
        "template": {
          "metadata": {
            "labels": {
              "ca.com/im": "provdir"
            },
            "name": "provdir"
          },
          "spec": {
            "containers": [
              {
                "env": [
                  {
                    "name": "DESTINATION",
                    "value": "/solution"
                  },
                  {
                    "name": "GITHUB_TOKEN",
                    "value": "${OAUTH_TOKEN}"
                  },
                  {
                    "name": "SOURCE",
                    "value": "${SOLUTION_CONFIGURATION}"
                  }
                ],
                "image": "store.vapp-security.solutions/vapp/sidecar-configsvc:latest",
                "name": "configuration",
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              },
              {
                "env": [
                  {
                    "name": "CONFIG",
                    "value": "forwardinc/provdir"
                  }
                ],
                "image": "store.vapp-security.solutions/directory/dxgrid:12.0.15.ga",
                "name": "provdir",
                "ports": [
                  {
                    "containerPort": 20391
                  },
                  {
                    "containerPort": 20394
                  }
                ],
                "readinessProbe": {
                  "tcpSocket": {
                    "port": 20391
                  },
                  "initialDelaySeconds": 20
                },
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              }
            ],
            "dnsPolicy": "ClusterFirst",
            "restartPolicy": "Always",
            "volumes": [
              {
                "name": "configuration",
                "emptyDir": {}
              }
            ]
          }
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "ReplicationController",
      "metadata": {
        "name": "provsrv"
      },
      "spec": {
        "replicas": 1,
        "selector": {
          "ca.com/im": "provsrv"
        },
        "template": {
          "metadata": {
            "labels": {
              "ca.com/im": "provsrv"
            },
            "name": "provsrv"
          },
          "spec": {
            "containers": [
              {
                "env": [
                  {
                    "name": "DESTINATION",
                    "value": "/solution"
                  },
                  {
                    "name": "GITHUB_TOKEN",
                    "value": "${OAUTH_TOKEN}"
                  },
                  {
                    "name": "SOURCE",
                    "value": "${SOLUTION_CONFIGURATION}"
                  }
                ],
                "image": "store.vapp-security.solutions/vapp/sidecar-configsvc:latest",
                "name": "configuration",
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              },
              {
                "env": [
                  {
                    "name": "CONFIG",
                    "value": "forwardinc/provsrv"
                  }
                ],
                "image": "store.vapp-security.solutions/imag/im-prov-server:12.6.06.ga",
                "name": "provsrv",
                "ports": [
                  {
                    "containerPort": 20389
                  },
                  {
                    "containerPort": 20390
                  }
                ],
                "capability": "SYS_ADMIN",
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              }
            ],
            "dnsPolicy": "ClusterFirst",
            "restartPolicy": "Always",
            "volumes": [
              {
                "name": "configuration",
                "emptyDir": {}
              }
            ]
          }
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "ReplicationController",
      "metadata": {
        "name": "userstore"
      },
      "spec": {
        "replicas": 1,
        "selector": {
          "ca.com/im": "userstore"
        },
        "template": {
          "metadata": {
            "labels": {
              "ca.com/im": "userstore"
            },
            "name": "userstore"
          },
          "spec": {
            "containers": [
              {
                "env": [
                  {
                    "name": "DESTINATION",
                    "value": "/solution"
                  },
                  {
                    "name": "GITHUB_TOKEN",
                    "value": "${OAUTH_TOKEN}"
                  },
                  {
                    "name": "SOURCE",
                    "value": "${SOLUTION_CONFIGURATION}"
                  }
                ],
                "image": "store.vapp-security.solutions/vapp/sidecar-configsvc:latest",
                "name": "configuration",
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              },
              {
                "env": [
                  {
                    "name": "CONFIG",
                    "value": "forwardinc/userstore"
                  }
                ],
                "image": "store.vapp-security.solutions/directory/dxgrid:12.0.15.ga",
                "name": "userstore",
                "ports": [
                  {
                    "containerPort": 13389
                  }
                ],
                "volumeMounts": [
                  {
                    "mountPath": "/solution",
                    "name": "configuration"
                  }
                ]
              }
            ],
            "dnsPolicy": "ClusterFirst",
            "restartPolicy": "Always",
            "volumes": [
              {
                "name": "configuration",
                "emptyDir": {}
              }
            ]
          }
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "annotations": {
          "ca.com/cluster-public-urlpath": "/castylesr5.1.1",
          "ca.com/cluster-public-urlpath-backend": "/castylesr5.1.1"
        },
        "labels": {
          "ca.com/cluster-public-service": "http"
        },
        "name": "castyle"
      },
      "spec": {
        "ports": [
          {
            "port": 80,
            "targetPort": 8080
          }
        ],
        "selector": {
          "ca.com/im": "im-server"
        },
        "sessionAffinity": "ClientIP"
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "name": "connserver"
      },
      "spec": {
        "ports": [
          {
            "name": "httpport",
            "port": 20080,
            "targetPort": 20080
          },
          {
            "name": "ldap",
            "port": 20410,
            "targetPort": 20410
          },
          {
            "name": "ldaps",
            "port": 20411,
            "targetPort": 20411
          },
          {
            "name": "httpsport",
            "port": 20443,
            "targetPort": 20443
          },
          {
            "name": "apache",
            "port": 22001,
            "targetPort": 22001
          },
          {
            "name": "apache2",
            "port": 22002,
            "targetPort": 22002
          },
          {
            "name": "rmiport",
            "port": 22099,
            "targetPort": 20099
          }
        ],
        "selector": {
          "ca.com/im": "connserver"
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "name": "database"
      },
      "spec": {
        "ports": [
          {
            "port": 3306,
            "targetPort": 3306
          }
        ],
        "selector": {
          "ca.com/im": "database"
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "annotations": {
          "ca.com/cluster-public-hostname": "forwardinc-ig.ca.local",
          "ca.com/cluster-public-url": "/eurekify/portal/login",
          "ca.com/cluster-public-urlpath": "/eurekify",
          "ca.com/cluster-public-urlpath-backend": "/eurekify",
          "ca.com/cluster-public-urltext": "Identity Governance Environment"
        },
        "labels": {
          "ca.com/cluster-public-service": "http"
        },
        "name": "ig-ui"
      },
      "spec": {
        "ports": [
          {
            "port": 80,
            "targetPort": 8080
          }
        ],
        "selector": {
          "ca.com/im": "ig-server"
        },
        "sessionAffinity": "ClientIP"
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "annotations": {
          "ca.com/cluster-public-url": "/sigma/admin",
          "ca.com/cluster-public-urltext": "Identity Portal Admin"
        },
        "labels": {
          "ca.com/cluster-public-service": "http"
        },
        "name": "ip-admin-ui"
      },
      "spec": {
        "ports": [
          {
            "port": 80,
            "targetPort": 8080
          }
        ],
        "selector": {
          "ca.com/im": "identity-portal-server"
        },
        "sessionAffinity": "ClientIP"
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "annotations": {
          "ca.com/cluster-public-hostname": "forwardinc.ca.local",
          "ca.com/cluster-public-url": "/sigma/app",
          "ca.com/cluster-public-urlpath": "/sigma",
          "ca.com/cluster-public-urlpath-backend": "/sigma",
          "ca.com/cluster-public-urltext": "Identity Portal"
        },
        "labels": {
          "ca.com/cluster-public-service": "http"
        },
        "name": "ip-ui"
      },
      "spec": {
        "ports": [
          {
            "port": 80,
            "targetPort": 8080
          }
        ],
        "selector": {
          "ca.com/im": "identity-portal-server"
        },
        "sessionAffinity": "ClientIP"
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "name": "provdir"
      },
      "spec": {
        "ports": [
          {
            "name": "router",
            "port": 20391,
            "targetPort": 20391
          },
          {
            "name": "main",
            "port": 20394,
            "targetPort": 20394
          }
        ],
        "selector": {
          "ca.com/im": "provdir"
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "name": "provsrv"
      },
      "spec": {
        "ports": [
          {
            "name": "provsrv89",
            "port": 20389,
            "targetPort": 20389
          },
          {
            "name": "provsrv90",
            "port": 20390,
            "targetPort": 20390
          }
        ],
        "selector": {
          "ca.com/im": "provsrv"
        }
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "annotations": {
          "ca.com/cluster-public-url": "/iam/im/forwardinc",
          "ca.com/cluster-public-urlpath": "/iam/im",
          "ca.com/cluster-public-urlpath-backend": "/iam/im",
          "ca.com/cluster-public-urltext": "ForwardInc Environment"
        },
        "labels": {
          "ca.com/cluster-public-service": "http"
        },
        "name": "ui"
      },
      "spec": {
        "ports": [
          {
            "port": 80,
            "targetPort": 8080
          }
        ],
        "selector": {
          "ca.com/im": "im-server"
        },
        "sessionAffinity": "ClientIP"
      }
    },
    {
      "apiVersion": "v1",
      "kind": "Service",
      "metadata": {
        "name": "userstore"
      },
      "spec": {
        "ports": [
          {
            "port": 13389,
            "targetPort": 13389
          }
        ],
        "selector": {
          "ca.com/im": "userstore"
        }
      }
    }
  ],
  "parameters": [
    {
      "description": "The Github OAuth token used to access your configuration.  Change this token if you use OAuth to access your custom configuration.",
      "name": "OAUTH_TOKEN",
      "value": ""
    },
    {
      "description": "The URL of your configuration.  Change this URL to use a custom configuration.",
      "name": "SOLUTION_CONFIGURATION",
      "value": "https://github.com/ca-imag/vapp-config-forwardinc/archive/12.6.06.ga.zip"
    },
    {
      "description": "Provide a Database Vendor name.  The Database Vendor should be sqlserver or oracle",
      "name": "IG_DB_VENDOR",
      "value": ""
    },
    {
      "description": "Provide a Database Host name which is used to store the data for Identity Governance",
      "name": "IG_DB_HOST",
      "value": ""
    },
    {
      "description": "Provide a Database Port number. If the value is not provided, the default port is 1433 for sqlserver and 1521 for oracle",
      "name": "IG_DB_PORT",
      "value": ""
    },
    {
      "description": "Provide a Database User name to connect to the Identity Governance Database Server",
      "name": "IG_DB_USER",
      "value": ""
    },
    {
      "description": "Provide a Database Password to connect to the Identity Governance Database Server",
      "name": "IG_DB_PASSWORD",
      "value": ""
    },
    {
      "description": "Provide a Password for Oracle Databases i.e SDB_DB, TMS_DB, REPORT_DB and WPDS_DB. The password will be used to connect the above Databases.",
      "name": "IG_DBS_PASSWORDS",
      "value": ""
    }
  ]
}
